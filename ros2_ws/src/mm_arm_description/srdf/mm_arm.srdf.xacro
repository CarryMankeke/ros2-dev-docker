<?xml version="1.0"?>
<robot name="mm_arm" xmlns:xacro="http://www.ros.org/wiki/xacro">
  <!-- Argumentos de configuración -->
  <xacro:arg name="prefix" default="mm_arm_"/>
  <xacro:arg name="scale" default="1.0"/>
  
  <!-- Propiedades del prefijo -->
  <xacro:property name="prefix" value="$(arg prefix)"/>
  <xacro:property name="scale" value="$(arg scale)"/>

  <!-- Test minimo: xacro mm_arm.srdf.xacro prefix:=mm_arm_ -->

  <!-- ==================== GRUPOS DE PLANIFICACIÓN ==================== -->
  
  <!-- Grupo para el brazo (6 joints rotacionales) -->
  <group name="arm">
    <joint name="${prefix}shoulder_pan_joint"/>
    <joint name="${prefix}shoulder_lift_joint"/>
    <joint name="${prefix}elbow_joint"/>
    <joint name="${prefix}wrist_1_joint"/>
    <joint name="${prefix}wrist_2_joint"/>
    <joint name="${prefix}wrist_3_joint"/>
    <joint name="${prefix}tool_joint"/>
  </group>

  <group_state name="home" group="arm">
    <joint name="${prefix}shoulder_pan_joint" value="0.0"/>
    <joint name="${prefix}shoulder_lift_joint" value="0.0"/>
    <joint name="${prefix}elbow_joint" value="0.0"/>
    <joint name="${prefix}wrist_1_joint" value="0.0"/>
    <joint name="${prefix}wrist_2_joint" value="0.0"/>
    <joint name="${prefix}wrist_3_joint" value="0.0"/>
  </group_state>

  <!-- Grupo para el gripper (si existe) -->
  <group name="gripper">
    <joint name="${prefix}gripper_joint"/>
  </group>

  <!-- Composición completa del brazo -->
  <group name="mm_arm_full">
    <group name="arm"/>
    <group name="gripper"/>
  </group>

  <!-- ==================== DESHABILITAR COLISIONES ==================== -->
  <!-- Deshabilitar colisiones entre links adyacentes (mismo material, no colisionan) -->
  <disable_collisions link1="${prefix}base_link" link2="${prefix}link_1" reason="Adjacent"/>
  <disable_collisions link1="${prefix}link_1" link2="${prefix}link_2" reason="Adjacent"/>
  <disable_collisions link1="${prefix}link_2" link2="${prefix}link_3" reason="Adjacent"/>
  <disable_collisions link1="${prefix}link_3" link2="${prefix}link_4" reason="Adjacent"/>
  <disable_collisions link1="${prefix}link_4" link2="${prefix}link_5" reason="Adjacent"/>
  <disable_collisions link1="${prefix}link_5" link2="${prefix}link_6" reason="Adjacent"/>
  
  <!-- Deshabilitar auto-colisiones (el robot no choca consigo mismo típicamente) -->
  <disable_collisions link1="${prefix}base_link" link2="${prefix}link_2" reason="Non-adjacent"/>
  <disable_collisions link1="${prefix}link_1" link2="${prefix}link_3" reason="Non-adjacent"/>
  <disable_collisions link1="${prefix}link_2" link2="${prefix}link_4" reason="Non-adjacent"/>
  <disable_collisions link1="${prefix}link_3" link2="${prefix}link_5" reason="Non-adjacent"/>
  <disable_collisions link1="${prefix}link_4" link2="${prefix}link_6" reason="Non-adjacent"/>

  <!-- ==================== END EFFECTOR ==================== -->
  <!-- Define el end effector (herramienta/gripper) -->
  <end_effector name="ee" parent_link="${prefix}tool0" parent_group="arm" group="gripper"/>

  <virtual_joint name="world_joint" type="fixed" parent_frame="world" child_link="${prefix}root_link"/>

  <!-- ==================== JOINT LIMITS OVERRIDE (OPCIONAL) ==================== -->
  <!-- Se pueden redefinir límites aquí si es necesario -->
  <!-- Ejemplo: aumentar límites de velocidad para escenarios específicos -->
  
</robot>
